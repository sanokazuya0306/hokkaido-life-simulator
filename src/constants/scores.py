"""
人生スコア計算のための統計データ定数

東京で生まれ育って最大限に充実した人生 = 100点 を基準とする
"""

# ============================================================================
# 出生地による機会格差（有効求人倍率ベース）
# 出典: 厚生労働省 一般職業紹介状況（2025年11月）
# ============================================================================
LOCATION_SCORES = {
    "東京": 100,  # 有効求人倍率 1.73（基準）
    "北海道": 54,  # 有効求人倍率 0.93（1.73の約54%）
}

# ============================================================================
# 性別による経済的機会格差
# 出典: 厚生労働省「賃金構造基本統計調査」2024年
# ============================================================================
GENDER_SCORES = {
    "男性": 100,  # 賃金100（基準）
    "女性": 76,   # 賃金75.8（男性の約76%）
}

# ============================================================================
# 学歴による生涯賃金格差
# 出典: 労働政策研究・研修機構「ユースフル労働統計」
# ============================================================================
EDUCATION_SCORES = {
    "大学卒": 100,  # 生涯賃金約2.7億円（基準）
    "高校卒": 75,   # 生涯賃金約2.0億円（大学卒の約75%）
    "中学卒": 60,   # 生涯賃金約1.6億円（大学卒の約60%）
}

# ============================================================================
# 大学進学先による機会格差
# 出典: 大学所在地の求人倍率と産業集積度
# ============================================================================
UNIVERSITY_DESTINATION_SCORES = {
    "東京都": 100,
    "神奈川県": 90,
    "大阪府": 85,
    "愛知県": 85,
    "京都府": 80,
    "兵庫県": 75,
    "福岡県": 70,
    "北海道": 60,
    "default": 65,
}

# ============================================================================
# 大学偏差値ランク別スコア
# ランク: S（難関国公立・早慶）、A（上位国公立・MARCH関関同立）、
#        B（中堅国公立・日東駒専）、C（その他国公立・中堅私立）、D（その他私立）
# ============================================================================
UNIVERSITY_RANK_SCORES = {
    "S": 100,  # 東大・京大・一橋・東工大・旧帝大・早慶
    "A": 90,   # 上位国公立・MARCH・関関同立
    "B": 80,   # 中堅国公立・日東駒専・産近甲龍
    "C": 70,   # その他国公立・中堅私立
    "D": 60,   # その他私立
    "default": 70,
}

# 大学名からランクへのマッピング
UNIVERSITY_RANKS = {
    # S ランク（難関国公立・早慶）
    "東京大学": "S",
    "京都大学": "S",
    "一橋大学": "S",
    "東京工業大学": "S",
    "北海道大学": "S",
    "東北大学": "S",
    "名古屋大学": "S",
    "大阪大学": "S",
    "九州大学": "S",
    "早稲田大学": "S",
    "慶應義塾大学": "S",
    "東京医科歯科大学": "S",
    "旭川医科大学": "S",
    "札幌医科大学": "S",
    
    # A ランク（上位国公立・MARCH・関関同立）
    "筑波大学": "A",
    "神戸大学": "A",
    "横浜国立大学": "A",
    "千葉大学": "A",
    "広島大学": "A",
    "岡山大学": "A",
    "金沢大学": "A",
    "お茶の水女子大学": "A",
    "東京外国語大学": "A",
    "東京農工大学": "A",
    "電気通信大学": "A",
    "東京海洋大学": "A",
    "東京学芸大学": "A",
    "首都大学東京": "A",
    "大阪公立大学": "A",
    "小樽商科大学": "A",
    "帯広畜産大学": "A",
    "室蘭工業大学": "A",
    "北見工業大学": "A",
    "公立はこだて未来大学": "A",
    "国際教養大学": "A",
    "会津大学": "A",
    # MARCH
    "明治大学": "A",
    "青山学院大学": "A",
    "立教大学": "A",
    "中央大学": "A",
    "法政大学": "A",
    # 関関同立
    "関西大学": "A",
    "関西学院大学": "A",
    "同志社大学": "A",
    "立命館大学": "A",
    # 上智・理科大
    "上智大学": "A",
    "東京理科大学": "A",
    
    # B ランク（中堅国公立・日東駒専・産近甲龍）
    "北海道教育大学": "B",
    "弘前大学": "B",
    "岩手大学": "B",
    "秋田大学": "B",
    "山形大学": "B",
    "福島大学": "B",
    "茨城大学": "B",
    "宇都宮大学": "B",
    "群馬大学": "B",
    "埼玉大学": "B",
    "新潟大学": "B",
    "信州大学": "B",
    "静岡大学": "B",
    "名古屋工業大学": "B",
    "岐阜大学": "B",
    "三重大学": "B",
    "滋賀大学": "B",
    "和歌山大学": "B",
    "鳥取大学": "B",
    "島根大学": "B",
    "山口大学": "B",
    "徳島大学": "B",
    "香川大学": "B",
    "愛媛大学": "B",
    "高知大学": "B",
    "佐賀大学": "B",
    "長崎大学": "B",
    "熊本大学": "B",
    "大分大学": "B",
    "宮崎大学": "B",
    "鹿児島大学": "B",
    "琉球大学": "B",
    "長岡技術科学大学": "B",
    "富山大学": "B",
    "福井大学": "B",
    "山梨大学": "B",
    "奈良女子大学": "B",
    "大阪教育大学": "B",
    "京都工芸繊維大学": "B",
    "京都教育大学": "B",
    "兵庫教育大学": "B",
    "九州工業大学": "B",
    "福岡教育大学": "B",
    "宮城教育大学": "B",
    "愛知教育大学": "B",
    "奈良教育大学": "B",
    "鳴門教育大学": "B",
    "札幌市立大学": "B",
    "公立千歳科学技術大学": "B",
    "横浜市立大学": "B",
    "名古屋市立大学": "B",
    "京都府立大学": "B",
    "神戸市外国語大学": "B",
    "兵庫県立大学": "B",
    "北九州市立大学": "B",
    # 日東駒専
    "日本大学": "B",
    "東洋大学": "B",
    # 産近甲龍
    "京都産業大学": "B",
    "近畿大学": "B",
    "甲南大学": "B",
    "龍谷大学": "B",
    # 南山・西南学院
    "南山大学": "B",
    "西南学院大学": "B",
    
    # C ランク（その他公立・中堅私立）
    "北海学園大学": "C",
    "北星学園大学": "C",
    "北海道科学大学": "C",
    "酪農学園大学": "C",
    "北海道医療大学": "C",
    "天使大学": "C",
    "藤女子大学": "C",
    "東北学院大学": "C",
    "東北福祉大学": "C",
    "獨協大学": "C",
    "文教大学": "C",
    "神田外語大学": "C",
    "千葉工業大学": "C",
    "神奈川大学": "C",
    "東海大学": "C",
    "中京大学": "C",
    "愛知大学": "C",
    "名城大学": "C",
    "愛知学院大学": "C",
    "関西外国語大学": "C",
    "摂南大学": "C",
    "広島修道大学": "C",
    "福岡大学": "C",
    "久留米大学": "C",
    "立命館アジア太平洋大学": "C",
    "金沢工業大学": "C",
    "松山大学": "C",
    "沖縄国際大学": "C",
    
    # D ランク（その他私立）- 明示的にリストに入れず、defaultで対応
}

def get_university_rank(university_name: str) -> str:
    """
    大学名からランクを取得
    
    Args:
        university_name: 大学名
        
    Returns:
        ランク（S/A/B/C/D）
    """
    if not university_name:
        return "default"
    return UNIVERSITY_RANKS.get(university_name, "D")

def get_university_rank_score(university_name: str) -> int:
    """
    大学名からスコアを取得
    
    Args:
        university_name: 大学名
        
    Returns:
        スコア（60〜100）
    """
    rank = get_university_rank(university_name)
    return UNIVERSITY_RANK_SCORES.get(rank, UNIVERSITY_RANK_SCORES["default"])

# ============================================================================
# 産業別の平均賃金スコア
# 出典: 厚生労働省「賃金構造基本統計調査」2024年
# ============================================================================
INDUSTRY_SALARY_SCORES = {
    "情報通信業": 100,
    "金融業，保険業": 95,
    "学術研究，専門・技術サービス業": 90,
    "電気・ガス・熱供給・水道業": 90,
    "教育，学習支援業": 85,
    "不動産業，物品賃貸業": 80,
    "製造業": 80,
    "建設業": 75,
    "運輸業，郵便業": 70,
    "卸売業，小売業": 65,
    "医療，福祉": 65,
    "複合サービス事業": 60,
    "サービス業（他に分類されないもの）": 55,
    "生活関連サービス業，娯楽業": 55,
    "農業，林業": 50,
    "漁業": 50,
    "宿泊業，飲食サービス業": 45,
    "default": 60,
}

# ============================================================================
# 死因によるスコア調整
# 「老衰」で亡くなるのは最も自然な死（高スコア）
# ============================================================================
DEATH_CAUSE_SCORES = {
    "老衰": 100,
    "その他": 80,
    "不慮の事故": 40,
    "自殺": 20,
    "default": 70,
}

# ============================================================================
# 各要素の重み（合計100%）
# ============================================================================
SCORE_WEIGHTS = {
    "location": 0.20,      # 出生地（20%）
    "gender": 0.15,        # 性別（15%）
    "education": 0.20,     # 学歴（20%）
    "university_dest": 0.05,  # 大学進学先（5%）
    "industry": 0.15,      # 就職産業（15%）
    "lifespan": 0.15,      # 寿命（15%）
    "death_cause": 0.10,   # 死因（10%）
}


def get_lifespan_score(age: int, gender: str) -> int:
    """
    寿命に基づくスコアを計算（長寿であるほど高スコア）
    
    出典: 厚生労働省「簡易生命表」2024年（平均寿命: 男性81.09歳、女性87.13歳）
    
    Args:
        age: 死亡時の年齢
        gender: 性別（"男性" or "女性"）
        
    Returns:
        0-100のスコア
    """
    # 理想的な寿命を90歳として100点
    ideal_age = 90
    min_score_age = 30  # 30歳以下で死亡は0点
    
    if age <= min_score_age:
        return 0
    elif age >= ideal_age:
        return 100
    else:
        # 30歳から90歳までを0点から100点にマッピング
        return int((age - min_score_age) / (ideal_age - min_score_age) * 100)
