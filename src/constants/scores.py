"""
人生スコア計算のための統計データ定数

東京で生まれ育って最大限に充実した人生 = 100点 を基準とする
"""

# ============================================================================
# 6段階ランク評価のしきい値
# 統計的スケール: 平均60点を基準に、正規分布的な評価
# SS: 上位1%（90点以上）、S: 上位5%（80点以上）、A: 上位20%（70点以上）
# B: 平均付近（50-70点）、C: 下位20%（30-50点）、D: 下位5%（30点未満）
# ============================================================================
RANK_THRESHOLDS = {
    "SS": 90,  # 90点以上（上位1%）
    "S": 80,   # 80点以上（上位5%）
    "A": 70,   # 70点以上（上位20%）
    "B": 50,   # 50点以上（平均付近）
    "C": 30,   # 30点以上（下位20%）
    "D": 0,    # 30点未満（下位5%）
}

RANK_LABELS = {
    "SS": "神ガチャ",
    "S": "大当たり",
    "A": "当たり",
    "B": "普通",
    "C": "ハズレ",
    "D": "大ハズレ",
}

def get_rank(score: float) -> str:
    """
    スコアからランク（SS/S/A/B/C/D）を取得
    
    統計的スケール:
    - SS: 90点以上（上位1%）
    - S: 80点以上（上位5%）
    - A: 70点以上（上位20%）
    - B: 50点以上（平均付近、50-70点）
    - C: 30点以上（下位20%）
    - D: 30点未満（下位5%）
    
    Args:
        score: 0-100のスコア
        
    Returns:
        ランク文字列
    """
    if score >= RANK_THRESHOLDS["SS"]:
        return "SS"
    elif score >= RANK_THRESHOLDS["S"]:
        return "S"
    elif score >= RANK_THRESHOLDS["A"]:
        return "A"
    elif score >= RANK_THRESHOLDS["B"]:
        return "B"
    elif score >= RANK_THRESHOLDS["C"]:
        return "C"
    else:
        return "D"

def get_rank_label(rank: str) -> str:
    """
    ランクからラベルを取得
    
    Args:
        rank: ランク（SS/S/A/B/C/D）
        
    Returns:
        ラベル文字列
    """
    return RANK_LABELS.get(rank, "")

# ============================================================================
# 出生地による機会格差（有効求人倍率ベース）
# 出典: 厚生労働省 一般職業紹介状況（2025年11月）
# ============================================================================
LOCATION_SCORES = {
    "東京": 100,  # 有効求人倍率 1.73（基準）
    "北海道": 54,  # 有効求人倍率 0.93（1.73の約54%）
}

# ============================================================================
# 親ガチャスコア用定数
# ============================================================================

# 親の学歴スコア
# 統計的スケール: 平均60点、最大（大学院）100点、最小（中学）0点
# 日本の学歴分布: 大学院2%、大学30%、短大専門20%、高校40%、中学8%
# 加重平均が約60点になるよう調整
PARENT_EDUCATION_SCORES = {
    # 「卒」付きバージョン
    "大学院卒": 100,
    "大学卒": 80,
    "短大・専門卒": 60,
    "高校卒": 50,
    "中学卒": 0,
    # 「卒」なしバージョン（実際のデータ形式）
    "大学院": 100,
    "大学": 80,
    "短大・専門": 60,
    "短大・専門学校": 60,
    "短大": 60,
    "専門": 60,
    "専門学校": 60,
    "高校": 50,
    "中学": 0,
    "中学校": 0,
    "default": 50,
}

# 世帯年収スコア（万円ベース）
# 統計的スケール: 平均60点、最大（1000万以上）100点、最小（100万未満）0点
# 日本の世帯年収中央値は約550万円（60点相当）
HOUSEHOLD_INCOME_SCORES = {
    "1000万円以上": 100,
    "900〜1000万円": 93,
    "800〜1000万円": 88,
    "800〜900万円": 85,
    "700〜1000万円": 82,
    "700〜800万円": 78,
    "600〜800万円": 73,
    "600〜700万円": 70,
    "500〜700万円": 65,
    "500〜600万円": 62,
    "400〜600万円": 60,
    "400〜500万円": 55,
    "300〜500万円": 48,
    "300〜400万円": 40,
    "200〜400万円": 32,
    "200〜300万円": 22,
    "200万円未満": 12,
    "100〜200万円": 8,
    "100万円未満": 0,
    "default": 60,
}

# 出生地スコア（親ガチャ用）
# 統計的スケール: 平均60点、最大（東京）100点、最小（最も機会の少ない地域）0点
# 東京100、北海道は全国平均より低いため50程度
BIRTHPLACE_SCORES = {
    "東京": 100,
    "北海道": 50,
    "default": 60,
}

# ============================================================================
# 性別による経済的機会格差
# 出典: 厚生労働省「賃金構造基本統計調査」2024年
# ============================================================================
GENDER_SCORES = {
    "男性": 100,  # 賃金100（基準）
    "女性": 76,   # 賃金75.8（男性の約76%）
}

# ============================================================================
# 学歴による生涯賃金格差
# 出典: 労働政策研究・研修機構「ユースフル労働統計」
# 統計的スケール: 平均60点、最大（大学卒）100点、最小（中学卒）0点
# 日本の学歴分布: 大学卒約55%、高校卒約40%、中学卒約5%
# 加重平均が約60点になるよう調整
# ============================================================================
EDUCATION_SCORES = {
    "大学卒": 100,  # 生涯賃金約2.7億円（最大）
    "短大・専門卒": 75,  # 生涯賃金約2.3億円（大学卒と高校卒の中間）
    "高校卒": 55,   # 生涯賃金約2.0億円（平均やや下）
    "中学卒": 0,    # 生涯賃金約1.6億円（最小）
}

# ============================================================================
# 大学進学先による機会格差
# 出典: 大学所在地の求人倍率と産業集積度
# ============================================================================
UNIVERSITY_DESTINATION_SCORES = {
    "東京都": 100,
    "神奈川県": 90,
    "大阪府": 85,
    "愛知県": 85,
    "京都府": 80,
    "兵庫県": 75,
    "福岡県": 70,
    "北海道": 60,
    "default": 65,
}

# ============================================================================
# 大学偏差値ランク別スコア
# ランク: S（難関国公立・早慶）、A（上位国公立・MARCH関関同立）、
#        B（中堅国公立・日東駒専）、C（その他国公立・中堅私立）、D（その他私立）
# ============================================================================
UNIVERSITY_RANK_SCORES = {
    "S": 100,  # 東大・京大・一橋・東工大・旧帝大・早慶
    "A": 90,   # 上位国公立・MARCH・関関同立
    "B": 80,   # 中堅国公立・日東駒専・産近甲龍
    "C": 70,   # その他国公立・中堅私立
    "D": 60,   # その他私立
    "default": 70,
}

# 大学名からランクへのマッピング
UNIVERSITY_RANKS = {
    # S ランク（難関国公立・早慶）
    "東京大学": "S",
    "京都大学": "S",
    "一橋大学": "S",
    "東京工業大学": "S",
    "北海道大学": "S",
    "東北大学": "S",
    "名古屋大学": "S",
    "大阪大学": "S",
    "九州大学": "S",
    "早稲田大学": "S",
    "慶應義塾大学": "S",
    "東京医科歯科大学": "S",
    "旭川医科大学": "S",
    "札幌医科大学": "S",
    
    # A ランク（上位国公立・MARCH・関関同立）
    "筑波大学": "A",
    "神戸大学": "A",
    "横浜国立大学": "A",
    "千葉大学": "A",
    "広島大学": "A",
    "岡山大学": "A",
    "金沢大学": "A",
    "お茶の水女子大学": "A",
    "東京外国語大学": "A",
    "東京農工大学": "A",
    "電気通信大学": "A",
    "東京海洋大学": "A",
    "東京学芸大学": "A",
    "首都大学東京": "A",
    "大阪公立大学": "A",
    "小樽商科大学": "A",
    "帯広畜産大学": "A",
    "室蘭工業大学": "A",
    "北見工業大学": "A",
    "公立はこだて未来大学": "A",
    "国際教養大学": "A",
    "会津大学": "A",
    # MARCH
    "明治大学": "A",
    "青山学院大学": "A",
    "立教大学": "A",
    "中央大学": "A",
    "法政大学": "A",
    # 関関同立
    "関西大学": "A",
    "関西学院大学": "A",
    "同志社大学": "A",
    "立命館大学": "A",
    # 上智・理科大
    "上智大学": "A",
    "東京理科大学": "A",
    
    # B ランク（中堅国公立・日東駒専・産近甲龍）
    "北海道教育大学": "B",
    "弘前大学": "B",
    "岩手大学": "B",
    "秋田大学": "B",
    "山形大学": "B",
    "福島大学": "B",
    "茨城大学": "B",
    "宇都宮大学": "B",
    "群馬大学": "B",
    "埼玉大学": "B",
    "新潟大学": "B",
    "信州大学": "B",
    "静岡大学": "B",
    "名古屋工業大学": "B",
    "岐阜大学": "B",
    "三重大学": "B",
    "滋賀大学": "B",
    "和歌山大学": "B",
    "鳥取大学": "B",
    "島根大学": "B",
    "山口大学": "B",
    "徳島大学": "B",
    "香川大学": "B",
    "愛媛大学": "B",
    "高知大学": "B",
    "佐賀大学": "B",
    "長崎大学": "B",
    "熊本大学": "B",
    "大分大学": "B",
    "宮崎大学": "B",
    "鹿児島大学": "B",
    "琉球大学": "B",
    "長岡技術科学大学": "B",
    "富山大学": "B",
    "福井大学": "B",
    "山梨大学": "B",
    "奈良女子大学": "B",
    "大阪教育大学": "B",
    "京都工芸繊維大学": "B",
    "京都教育大学": "B",
    "兵庫教育大学": "B",
    "九州工業大学": "B",
    "福岡教育大学": "B",
    "宮城教育大学": "B",
    "愛知教育大学": "B",
    "奈良教育大学": "B",
    "鳴門教育大学": "B",
    "札幌市立大学": "B",
    "公立千歳科学技術大学": "B",
    "横浜市立大学": "B",
    "名古屋市立大学": "B",
    "京都府立大学": "B",
    "神戸市外国語大学": "B",
    "兵庫県立大学": "B",
    "北九州市立大学": "B",
    # 日東駒専
    "日本大学": "B",
    "東洋大学": "B",
    # 産近甲龍
    "京都産業大学": "B",
    "近畿大学": "B",
    "甲南大学": "B",
    "龍谷大学": "B",
    # 南山・西南学院
    "南山大学": "B",
    "西南学院大学": "B",
    
    # C ランク（その他公立・中堅私立）
    "北海学園大学": "C",
    "北星学園大学": "C",
    "北海道科学大学": "C",
    "酪農学園大学": "C",
    "北海道医療大学": "C",
    "天使大学": "C",
    "藤女子大学": "C",
    "東北学院大学": "C",
    "東北福祉大学": "C",
    "獨協大学": "C",
    "文教大学": "C",
    "神田外語大学": "C",
    "千葉工業大学": "C",
    "神奈川大学": "C",
    "東海大学": "C",
    "中京大学": "C",
    "愛知大学": "C",
    "名城大学": "C",
    "愛知学院大学": "C",
    "関西外国語大学": "C",
    "摂南大学": "C",
    "広島修道大学": "C",
    "福岡大学": "C",
    "久留米大学": "C",
    "立命館アジア太平洋大学": "C",
    "金沢工業大学": "C",
    "松山大学": "C",
    "沖縄国際大学": "C",
    
    # D ランク（その他私立）- 明示的にリストに入れず、defaultで対応
}

def get_university_rank(university_name: str) -> str:
    """
    大学名からランクを取得
    
    Args:
        university_name: 大学名
        
    Returns:
        ランク（S/A/B/C/D）
    """
    if not university_name:
        return "default"
    return UNIVERSITY_RANKS.get(university_name, "D")

def get_university_rank_score(university_name: str) -> int:
    """
    大学名からスコアを取得
    
    Args:
        university_name: 大学名
        
    Returns:
        スコア（60〜100）
    """
    rank = get_university_rank(university_name)
    return UNIVERSITY_RANK_SCORES.get(rank, UNIVERSITY_RANK_SCORES["default"])

# ============================================================================
# 産業別の平均賃金スコア
# 出典: 厚生労働省「賃金構造基本統計調査」2024年
# ============================================================================
INDUSTRY_SALARY_SCORES = {
    "情報通信業": 100,
    "金融業，保険業": 95,
    "学術研究，専門・技術サービス業": 90,
    "電気・ガス・熱供給・水道業": 90,
    "教育，学習支援業": 85,
    "不動産業，物品賃貸業": 80,
    "製造業": 80,
    "建設業": 75,
    "運輸業，郵便業": 70,
    "卸売業，小売業": 65,
    "医療，福祉": 65,
    "複合サービス事業": 60,
    "サービス業（他に分類されないもの）": 55,
    "生活関連サービス業，娯楽業": 55,
    "農業，林業": 50,
    "漁業": 50,
    "宿泊業，飲食サービス業": 45,
    "default": 60,
}

# ============================================================================
# 死因によるスコア調整
# 「老衰」で亡くなるのは最も自然な死（高スコア）
# ============================================================================
DEATH_CAUSE_SCORES = {
    "老衰": 100,
    "その他": 80,
    "不慮の事故": 40,
    "自殺": 20,
    "default": 70,
}

# ============================================================================
# 各要素の重み（合計100%）
# ============================================================================
SCORE_WEIGHTS = {
    "location": 0.20,      # 出生地（20%）
    "gender": 0.15,        # 性別（15%）
    "education": 0.20,     # 学歴（20%）
    "university_dest": 0.05,  # 大学進学先（5%）
    "industry": 0.15,      # 就職産業（15%）
    "lifespan": 0.15,      # 寿命（15%）
    "death_cause": 0.10,   # 死因（10%）
}


def get_lifespan_score(age: int, gender: str) -> int:
    """
    寿命に基づくスコアを計算（長寿であるほど高スコア）
    
    統計的スケール: 平均60点、最大（100歳）100点、最小（0歳）0点
    平均寿命（男性81歳、女性87歳）が60点になるよう調整
    
    出典: 厚生労働省「簡易生命表」2024年（平均寿命: 男性81.09歳、女性87.13歳）
    
    Args:
        age: 死亡時の年齢
        gender: 性別（"男性" or "女性"）
        
    Returns:
        0-100のスコア
    """
    # 性別に応じた平均寿命
    if gender == "女性":
        avg_lifespan = 87.13
        max_age = 105  # 最大想定年齢
    else:
        avg_lifespan = 81.09
        max_age = 100  # 最大想定年齢
    
    min_age = 0  # 最小年齢
    
    # 平均寿命を60点とする変換
    # スコア = 60 + (age - avg_lifespan) * (40 / (max_age - avg_lifespan)) for age >= avg_lifespan
    # スコア = 60 - (avg_lifespan - age) * (60 / avg_lifespan) for age < avg_lifespan
    
    if age >= max_age:
        return 100
    elif age <= min_age:
        return 0
    elif age >= avg_lifespan:
        # 平均寿命以上: 60点から100点の範囲
        score = 60 + (age - avg_lifespan) * (40 / (max_age - avg_lifespan))
        return min(100, int(score))
    else:
        # 平均寿命未満: 0点から60点の範囲
        score = 60 * (age / avg_lifespan)
        return max(0, int(score))


# ============================================================================
# 人生スコア用：生涯年収関連
# ============================================================================

# 学歴別の基準生涯年収（万円）
# 出典: 労働政策研究・研修機構「ユースフル労働統計」
LIFETIME_INCOME_BASE = {
    "大学卒": 27000,   # 2.7億円
    "短大・専門卒": 23000,   # 2.3億円（大学卒と高校卒の中間）
    "高校卒": 20000,   # 2.0億円
    "中学卒": 16000,   # 1.6億円
}

# 生涯年収スコアの基準（万円）
# 統計的スケール: 平均60点、最大（4億円）100点、最小（0円）0点
# 日本の平均生涯年収は約2.2億円（60点相当）
LIFETIME_INCOME_SCORE_BASE = {
    "max": 40000,      # 4億円: 100点
    "average": 22000,  # 2.2億円: 60点（日本の平均）
    "min": 0,          # 0円: 0点
}

def get_lifetime_income_score(lifetime_income: float) -> int:
    """
    生涯年収からスコアを計算
    
    統計的スケール: 平均60点、最大（4億円）100点、最小（0円）0点
    
    Args:
        lifetime_income: 生涯年収（万円）
        
    Returns:
        0-100のスコア
    """
    max_income = LIFETIME_INCOME_SCORE_BASE["max"]
    avg_income = LIFETIME_INCOME_SCORE_BASE["average"]
    min_income = LIFETIME_INCOME_SCORE_BASE["min"]
    
    if lifetime_income >= max_income:
        return 100
    elif lifetime_income <= min_income:
        return 0
    elif lifetime_income >= avg_income:
        # 平均以上: 60点から100点の範囲
        ratio = (lifetime_income - avg_income) / (max_income - avg_income)
        score = 60 + ratio * 40
        return min(100, int(score))
    else:
        # 平均未満: 0点から60点の範囲
        ratio = lifetime_income / avg_income
        score = ratio * 60
        return max(0, int(score))


# ============================================================================
# 企業規模別の賃金補正係数
# 出典: 厚生労働省「令和5年賃金構造基本統計調査」
# 大企業（1000人以上）を基準(1.00)とした場合の賃金比率
# ============================================================================
COMPANY_SIZE_SALARY_MULTIPLIER = {
    "大企業": 1.00,   # 1000人以上（基準）
    "中企業": 0.82,   # 100-999人（大企業の約82%）
    "小企業": 0.72,   # 10-99人（大企業の約72%）
    "default": 0.82,  # デフォルトは中企業
}

# 学歴別の企業規模分布（%）
# 出典: 文部科学省「学校基本調査」、リクルートワークス研究所
# 大卒は大企業への就職率が高く、高卒・中卒は中小企業が中心
COMPANY_SIZE_DISTRIBUTION_BY_EDUCATION = {
    "大学卒": {
        "大企業": 35,   # 大卒の約35%が従業員1000人以上企業に就職
        "中企業": 40,   # 約40%が100-999人企業
        "小企業": 25,   # 約25%が99人以下企業
    },
    "短大・専門卒": {
        "大企業": 20,   # 短大・専門卒の約20%が大企業
        "中企業": 45,   # 約45%が中企業
        "小企業": 35,   # 約35%が小企業
    },
    "高校卒": {
        "大企業": 15,   # 高卒の約15%が大企業
        "中企業": 45,   # 約45%が中企業
        "小企業": 40,   # 約40%が小企業
    },
    "中学卒": {
        "大企業": 5,    # 中卒はほとんど大企業に入れない
        "中企業": 30,   # 約30%が中企業
        "小企業": 65,   # 約65%が小企業
    },
    "default": {
        "大企業": 20,
        "中企業": 40,
        "小企業": 40,
    },
}

# ============================================================================
# 雇用形態別の賃金補正係数
# 出典: 厚生労働省「令和5年賃金構造基本統計調査」
# 正社員を基準(1.00)とした場合の賃金比率
# ============================================================================
EMPLOYMENT_TYPE_SALARY_MULTIPLIER = {
    "正社員": 1.00,    # 正社員（基準）
    "非正規": 0.65,    # 非正規雇用（正社員の約65%）
    "default": 1.00,
}

# 学歴・性別別の正社員率（%）
# 出典: 総務省「労働力調査」2024年
# 学歴が高いほど正社員率が高い、女性は男性より正社員率が低い傾向
EMPLOYMENT_TYPE_DISTRIBUTION = {
    "大学卒": {
        "男性": {"正社員": 90, "非正規": 10},
        "女性": {"正社員": 75, "非正規": 25},
    },
    "短大・専門卒": {
        "男性": {"正社員": 80, "非正規": 20},
        "女性": {"正社員": 65, "非正規": 35},
    },
    "高校卒": {
        "男性": {"正社員": 75, "非正規": 25},
        "女性": {"正社員": 55, "非正規": 45},
    },
    "中学卒": {
        "男性": {"正社員": 55, "非正規": 45},
        "女性": {"正社員": 35, "非正規": 65},
    },
    "default": {
        "男性": {"正社員": 75, "非正規": 25},
        "女性": {"正社員": 55, "非正規": 45},
    },
}
